<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agenda.BenjaminTjoa.com</title>
  <link rel="icon" href="https://www.BenjaminTjoa.com/BT.png" type="image/x-icon">
  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500&display=swap" crossorigin="anonymous">
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7LD1XPEFCZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7LD1XPEFCZ');
</script>
  <!-- Firebase SDK's -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD7sbunkQLFKqC1z8S7MBZts_pz-y-QXnc",
      authDomain: "agenda-benjamintjoa-nl.firebaseapp.com",
      projectId: "agenda-benjamintjoa-nl",
      storageBucket: "agenda-benjamintjoa-nl.firebasestorage.app",
      messagingSenderId: "994953800925",
      appId: "1:994953800925:web:878a95b40501683e423f34",
      databaseURL: "https://agenda-benjamintjoa-nl-default-rtdb.europe-west1.firebasedatabase.app"
    };
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
  </script>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: #000;
      color: #fff;
    }
    #login-screen {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100%;
    }
    #login-box {
      background-color: rgba(28, 28, 30, 0.8);
      padding: 40px;
      border-radius: 18px;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      width: 300px;
      height: 300px;
      text-align: center;
    }
    h2 {
      margin-bottom: 30px;
      font-weight: 500;
      font-size: 24px;
    }
    input {
      display: block;
      margin: 20px 0;
      padding: 12px;
      width: 100%;
      background-color: rgba(118, 118, 128, 0.24);
      border: none;
      border-radius: 10px;
      color: #fff;
      font-size: 16px;
      box-sizing: border-box;
    }
    input::placeholder {
      color: #8e8e93;
    }
    button {
      background-color: #0A84FF;
      color: #fff;
      padding: 12px 0;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      width: 100%;
      font-size: 16px;
      font-weight: 500;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #007AFF;
    }
    #rememberContainer {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      margin-top: 10px;
    }
    #rememberContainer input {
      width: 16px;
      height: 16px;
    }
    #rememberContainer select {
      padding: 4px;
      font-size: 14px;
      border-radius: 5px;
      border: none;
      background-color: rgba(118, 118, 128, 0.24);
      color: #fff;
    }
    #welcome-screen {
      display: none;
      background-color: #000;
      color: #fff;
      height: 100%;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;
      text-align: center;
      flex-direction: column;
    }
    .rainbow-text {
      font-weight: bold;
      background: linear-gradient(90deg, #cb1333, #de45c1, #b96be2, #84a9e0, #23d43b, #d0bb08, #eb6d17);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      display: inline-block;
    }
    #inspirational-message {
      margin-top: 20px;
      font-size: 16px;
      text-align: center;
    }
    #AgendaSection {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
    }
    #AgendaSection iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <div id="login-screen">
    <div id="login-box">
      <h2>Inloggen</h2>
      <input type="text" id="leerlingnummer" placeholder="Voer je leerlingnummer in">
      <input type="password" id="wachtwoord" placeholder="Voer het wachtwoord in">
      <button id="loginButton">Log in</button>
      <div id="rememberContainer">
        <input type="checkbox" id="rememberMe">
        <label for="rememberMe">Onthoud mij voor:</label>
        <select id="rememberDuration">
          <option value="1">1 dag</option>
          <option value="7">1 week</option>
        </select>
      </div>
      <p id="message"></p>
    </div>
    <div id="inspirational-message"></div>
  </div>
  <div id="welcome-screen">
    <div id="welcome-message"></div>
  </div>
  <div id="AgendaSection">
    <iframe src="https://teamup.com/ksou85q5vpet598joc"></iframe>
  </div>

  <script>
    function setCookie(cname, cvalue, exdays) {
      const d = new Date();
      d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
      const expires = "expires=" + d.toUTCString();
      document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }
    function getCookie(cname) {
      const name = cname + "=";
      const decodedCookie = decodeURIComponent(document.cookie);
      const ca = decodedCookie.split(';');
      for (let i = 0; i < ca.length; i++) {
        let c = ca[i].trim();
        if (c.indexOf(name) === 0) {
          return c.substring(name.length, c.length);
        }
      }
      return "";
    }

    const inspirationalMessages = [
      "Ontdek je potentieel, één taak tegelijk.",
      "Jouw toekomst begint met elke opdracht die je plant.",
      "Organiseer vandaag, excelleer morgen.",
      "Maak van elke dag een meesterwerk van productiviteit.",
      "Je agenda: de blauwdruk van je succes.",
      "Transformeer je doelen in realiteit, stap voor stap.",
      "Elke geplande taak is een stap dichter bij je dromen.",
      "Jouw tijd, jouw canvas. Maak er iets moois van.",
      "Balanceer je leven, één agenda-item per keer.",
      "Innoveer je leerproces met slimme planning.",
      "Elk moment is een kans om te groeien.",
      "Je agenda is de sleutel tot je toekomst.",
      "Plannen is dromen met deadlines.",
      "Maak van je dag een meesterwerk.",
      "Jouw potentieel kent geen grenzen.",
      "Elke taak voltooid is een overwinning gevierd.",
      "Ontdek de kracht van gestructureerde creativiteit.",
      "Je bent de architect van je eigen succes.",
      "Leren is het avontuur van een leven.",
      "Organisatie is de fundering van excellentie.",
      "Jouw inspanning van vandaag vormt je morgen.",
      "Elk moment telt, maak het waardevol.",
      "Transformeer uitdagingen in kansen.",
      "Je agenda is je roadmap naar succes.",
      "Elke dag is een nieuwe kans om te excelleren.",
      "Discipline is de brug tussen doelen en prestaties.",
      "Jouw toekomst wordt gevormd door je dagelijkse keuzes.",
      "Wees de beste versie van jezelf, elke dag opnieuw.",
      "Succes is de som van kleine inspanningen, dag in dag uit.",
      "Jouw potentieel is onbegrensd, ontdek het.",
      "Elke taak voltooid is een stap voorwaarts.",
      "Leren is groeien, elke dag een beetje meer.",
      "Je bent de auteur van je eigen levensverhaal.",
      "Maak van je dromen doelen, en van je doelen realiteit.",
      "Jouw inzet vandaag bepaalt je succes morgen.",
      "Elke uitdaging is een kans om te leren en te groeien.",
      "Je bent sterker dan je denkt, slimmer dan je weet.",
      "Ontwikkel gewoontes die je dichter bij je doelen brengen.",
      "Jouw tijd is kostbaar, investeer het wijs.",
      "Elk moment is een kans om het verschil te maken.",
      "Je bent de kunstenaar van je eigen leven.",
      "Laat je passie je kompas zijn.",
      "Kleine stappen leiden tot grote veranderingen.",
      "Jouw potentieel is als een zaadje, voed het elke dag.",
      "Elke nieuwe dag is een onbeschreven bladzijde.",
      "Je bent de schepper van je eigen mogelijkheden.",
      "Leren is een reis, geniet van elke stap.",
      "Jouw toewijding vandaag vormt je toekomst.",
      "Elke uitdaging overwonnen is een les geleerd.",
      "Je bent capabel tot meer dan je denkt.",
      "Maak van je zwaktes je sterktes.",
      "Jouw unieke pad leidt naar jouw unieke bestemming.",
      "Elke dag is een nieuwe kans om te schitteren.",
      "Je bent de held van je eigen verhaal.",
      "Laat je nieuwsgierigheid je leiden naar nieuwe hoogtes.",
      "Jouw groei is onbegrensd, blijf jezelf uitdagen.",
      "Elke seconde telt, maak ze waardevol.",
      "Je bent de architect van je eigen geluk.",
      "Leren is leven, en leven is leren.",
      "Jouw inspanning van vandaag is de sleutel tot morgen.",
      "Elke hindernis overwonnen maakt je sterker.",
      "Je bent de dirigent van je eigen succes.",
      "Laat je dromen je motivatie zijn.",
      "Jouw potentieel is eindeloos, ontdek het elke dag.",
      "Elke dag is een nieuwe kans om te excelleren.",
      "Je bent de schrijver van je eigen toekomst.",
      "Leer, groei, en inspireer anderen.",
      "Jouw pad naar succes begint met de eerste stap.",
      "Elke prestatie begint met de beslissing om het te proberen.",
      "Je bent sterker dan je obstakels.",
      "Laat je passie je drijfveer zijn.",
      "Jouw toekomst is wat je er zelf van maakt.",
      "Elke dag is een geschenk, maak er iets moois van.",
      "Je bent de kapitein van je eigen schip.",
      "Leren is de sleutel die alle deuren opent.",
      "Jouw reis naar excellentie begint hier en nu.",
      "Elke uitdaging is een kans in vermomming.",
      "Je bent de vormgever van je eigen bestemming.",
      "Laat je nieuwsgierigheid je leiden naar nieuwe ontdekkingen.",
      "Jouw potentieel is als een diamant, blijf het polijsten.",
      "Elke stap vooruit is een overwinning.",
      "Je bent de sculpteur van je eigen leven.",
      "Leer van gisteren, leef voor vandaag, hoop voor morgen.",
      "Jouw toewijding is de sleutel tot je succes.",
      "Elke dag is een nieuwe kans om te groeien en te leren.",
      "Je bent de regisseur van je eigen leven.",
      "Laat je dromen je kompas zijn en je acties je voertuig.",
      "Jouw reis naar kennis is eindeloos en fascinerend.",
      "Elke ervaring is een les, elke les een stap vooruit.",
      "Je bent de kunstenaar van je eigen meesterwerk.",
      "Leren is het avontuur van een leven, geniet ervan.",
      "Jouw potentieel is onbegrensd, blijf het verkennen.",
      "Elke dag is een nieuwe pagina in het boek van je leven.",
      "Je bent de hoofdrolspeler in je eigen succesverhaal.",
      "Laat je passie je gids zijn naar grootsheid.",
      "Jouw toekomst wordt gevormd door je acties van vandaag.",
      "Elke uitdaging overwonnen is een trede op de ladder naar succes.",
      "Je bent de architect van je eigen dromen.",
      "Leer, groei, evolueer, en inspireer."
    ];

    function getRandomColor() {
      const rand = Math.random();
      if (rand < 0.48) return '#007AFF';
      if (rand < 0.96) return '#FF2D55';
      if (rand < 0.9989) return '#FFCC00';
      if (rand < 0.999) return '#AF52DE';
      return '#34C759';
    }

    function getRandomMessage(messages) {
      const randomIndex = Math.floor(Math.random() * messages.length);
      return messages[randomIndex];
    }

    function displayInspirationalMessage() {
      const messageElement = document.getElementById('inspirational-message');
      const message = getRandomMessage(inspirationalMessages);
      const color = getRandomColor();
      messageElement.textContent = message;
      messageElement.style.color = color;
    }

    function formatDate(date) {
      const day = ("0" + date.getDate()).slice(-2);
      const month = ("0" + (date.getMonth() + 1)).slice(-2);
      const year = date.getFullYear();
      return `${day}-${month}-${year}`;
    }

    function formatTime(date) {
      let hours = ("0" + date.getHours()).slice(-2);
      let minutes = ("0" + date.getMinutes()).slice(-2);
      let seconds = Math.floor(date.getSeconds() / 10) * 10;
      seconds = ("0" + seconds).slice(-2);
      return `${hours}:${minutes}:${seconds}`;
    }

    async function getCurrentTime() {
      try {
        const response = await fetch("https://timeapi.io/api/Time/current/zone?timeZone=Europe/Amsterdam");
        if (response.ok) {
          const data = await response.json();
          return new Date(data.dateTime);
        } else {
          return new Date();
        }
      } catch (error) {
        console.error("Time server error:", error);
        return new Date();
      }
    }

    async function startOnlineStatusUpdate(leerlingnummer) {
      const now = await getCurrentTime();
      const currentSeconds = now.getSeconds();
      const delay = (10 - (currentSeconds % 10)) * 1000;
      setTimeout(async () => {
        updateOnlineStatus(leerlingnummer);
        setInterval(() => {
          updateOnlineStatus(leerlingnummer);
        }, 10000);
      }, delay);
    }

    async function updateOnlineStatus(leerlingnummer) {
      const now = await getCurrentTime();
      const datum = formatDate(now);
      const tijd = formatTime(now);
      console.log("Updating online status voor:", leerlingnummer, datum, tijd);
      const userRef = database.ref('gebruikers/' + leerlingnummer);
      userRef.update({
        laatsteOnlineDatum: datum,
        laatsteOnlineTijd: tijd
      });
    }

    async function autoLogin(loggedInUser) {
      console.log("Auto login voor:", loggedInUser);
      try {
        const leerlingSnapshot = await database.ref('gebruikers/' + loggedInUser).once('value');
        if (leerlingSnapshot.exists()) {
          const leerling = leerlingSnapshot.val();
          const huidigeLoginTeller = leerling.loginTeller || 0;
          await database.ref('gebruikers/' + loggedInUser).update({
            loginTeller: huidigeLoginTeller + 1
          });
          document.getElementById('login-screen').style.display = 'none';
          const welcomeScreen = document.getElementById('welcome-screen');
          const welcomeMessage = document.getElementById('welcome-message');
          welcomeScreen.style.display = 'flex';
          welcomeMessage.innerHTML = '';
          const fullName = `<span class="rainbow-text">${leerling.voornaam} ${leerling.achternaam}</span>`;
          welcomeMessage.innerHTML = `Welkom ${fullName}!<br>`;
          const randomWelcomeMessage = getRandomMessage(inspirationalMessages);
          setTimeout(() => typeWriter(`Wat mooi dat je Agenda.BenjaminTjoa.com gebruikt! ${randomWelcomeMessage}`, welcomeMessage, 0), 1000);
          startOnlineStatusUpdate(loggedInUser);
        }
      } catch (error) {
        console.error("Auto login fout:", error);
      }
    }

    async function verifyLeerling() {
      const leerlingnummer = document.getElementById('leerlingnummer').value.trim();
      const wachtwoord = document.getElementById('wachtwoord').value.trim().toLowerCase();
      const messageElement = document.getElementById('message');
      
      console.log("Login poging voor:", leerlingnummer);
      if (!leerlingnummer || !wachtwoord) {
        messageElement.textContent = "Vul alstublieft zowel leerlingnummer als wachtwoord in.";
        return;
      }
      
      try {
        const leerlingSnapshot = await database.ref('gebruikers/' + leerlingnummer).once('value');
        if (leerlingSnapshot.exists()) {
          const leerling = leerlingSnapshot.val();
          if (
            wachtwoord === 'ecolle' ||
            wachtwoord === leerling.voornaam.toLowerCase() ||
            wachtwoord === leerling.achternaam.toLowerCase() ||
            wachtwoord === (leerling.voornaam.toLowerCase() + ' ' + leerling.achternaam.toLowerCase())
          ) {
            console.log("Login succesvol voor:", leerlingnummer);
            const huidigeLoginTeller = leerling.loginTeller || 0;
            await database.ref('gebruikers/' + leerlingnummer).update({
              loginTeller: huidigeLoginTeller + 1
            });
            if (document.getElementById("rememberMe").checked) {
              const duration = parseInt(document.getElementById("rememberDuration").value, 10);
              setCookie("loggedInUser", leerlingnummer, duration);
            }
            document.getElementById('login-screen').style.display = 'none';
            const welcomeScreen = document.getElementById('welcome-screen');
            const welcomeMessage = document.getElementById('welcome-message');
            welcomeScreen.style.display = 'flex';
            welcomeMessage.innerHTML = '';
            const fullName = `<span class="rainbow-text">${leerling.voornaam} ${leerling.achternaam}</span>`;
            welcomeMessage.innerHTML = `Welkom ${fullName}!<br>`;
            const randomWelcomeMessage = getRandomMessage(inspirationalMessages);
            setTimeout(() => typeWriter(`Wat mooi dat je Agenda.BenjaminTjoa.com gebruikt! ${randomWelcomeMessage}`, welcomeMessage, 0), 1000);
            startOnlineStatusUpdate(leerlingnummer);
          } else {
            console.log("Onjuist wachtwoord voor:", leerlingnummer);
            messageElement.textContent = "Onjuist wachtwoord. Probeer het opnieuw.";
          }
        } else {
          console.log("Leerling niet gevonden:", leerlingnummer);
          messageElement.textContent = "Deze website is eigenlijk alleen voor leerlingen uit 2E. Mocht je toch een account willen, stuur een mail naar: Agenda@BenjaminTjoa.com.";
        }
      } catch (error) {
        console.error("Fout bij login:", error);
        messageElement.textContent = "Er is een fout opgetreden. Probeer het later opnieuw.";
      }
    }

    function typeWriter(text, element, index) {
      if (index < text.length) {
        element.innerHTML += text.charAt(index);
        index++;
        setTimeout(() => typeWriter(text, element, index), 50);
      } else {
        setTimeout(() => {
          document.getElementById('welcome-screen').style.display = 'none';
          document.getElementById('AgendaSection').style.display = 'block';
        }, 1000);
      }
    }

    document.getElementById('loginButton').addEventListener('click', verifyLeerling);
    document.addEventListener('keydown', (e) => {
      const leerlingnummerField = document.getElementById('leerlingnummer');
      const wachtwoordField = document.getElementById('wachtwoord');
      if (e.key === 'Enter') {
        if (document.activeElement === leerlingnummerField) {
          wachtwoordField.focus();
        } else if (document.activeElement === wachtwoordField) {
          verifyLeerling();
        }
      }
    });

    window.onload = function() {
      displayInspirationalMessage();
      const loggedInUser = getCookie("loggedInUser");
      if (loggedInUser) {
        autoLogin(loggedInUser);
      }
    };
  </script>
</body>
</html>
